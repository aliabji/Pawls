{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _excluded = [\"forwardedRef\"];\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport hoistStatics from 'hoist-non-react-statics';\nimport * as Modifiers from \"./modifiers\";\nimport { Scheme } from \"../style\";\nimport forwardRef from \"./forwardRef\";\nimport UIComponent from \"./UIComponent\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction asBaseComponent(WrappedComponent) {\n  var BaseComponent = function (_UIComponent) {\n    _inherits(BaseComponent, _UIComponent);\n\n    var _super = _createSuper(BaseComponent);\n\n    function BaseComponent() {\n      var _this;\n\n      _classCallCheck(this, BaseComponent);\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      _this = _super.call.apply(_super, [this].concat(args));\n      _this.state = {\n        error: false\n      };\n\n      _this.appearanceListener = function () {\n        _this.setState({\n          colorScheme: Scheme.getSchemeType()\n        });\n      };\n\n      return _this;\n    }\n\n    _createClass(BaseComponent, [{\n      key: \"componentDidMount\",\n      value: function componentDidMount() {\n        Scheme.addChangeListener(this.appearanceListener);\n      }\n    }, {\n      key: \"componentWillUnmount\",\n      value: function componentWillUnmount() {\n        Scheme.removeChangeListener(this.appearanceListener);\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        var _UIComponent$defaultP;\n\n        var themeProps = BaseComponent.getThemeProps(this.props, this.context);\n        var modifiers = Modifiers.generateModifiersStyle(undefined, themeProps);\n\n        var forwardedRef = themeProps.forwardedRef,\n            others = _objectWithoutProperties(themeProps, _excluded);\n\n        return this.state.error && ((_UIComponent$defaultP = UIComponent.defaultProps) == null ? void 0 : _UIComponent$defaultP.renderError) || _jsx(WrappedComponent, _objectSpread(_objectSpread({}, others), {}, {\n          modifiers: modifiers,\n          ref: forwardedRef\n        }));\n      }\n    }], [{\n      key: \"getDerivedStateFromError\",\n      value: function getDerivedStateFromError(error) {\n        var _UIComponent$defaultP2;\n\n        (_UIComponent$defaultP2 = UIComponent.defaultProps) == null ? void 0 : _UIComponent$defaultP2.onError == null ? void 0 : _UIComponent$defaultP2.onError(error, WrappedComponent.defaultProps);\n        return {\n          error: true\n        };\n      }\n    }]);\n\n    return BaseComponent;\n  }(UIComponent);\n\n  BaseComponent.getThemeProps = function (props, context) {\n    return Modifiers.getThemeProps.call(WrappedComponent, props, context);\n  };\n\n  hoistStatics(BaseComponent, WrappedComponent);\n  BaseComponent.displayName = WrappedComponent.displayName;\n  BaseComponent.propTypes = WrappedComponent.propTypes;\n  BaseComponent.defaultProps = WrappedComponent.defaultProps;\n  return forwardRef(BaseComponent);\n}\n\nexport default asBaseComponent;","map":{"version":3,"sources":["/Users/aliabji/code/dogs/Pawls/node_modules/react-native-ui-lib/src/commons/asBaseComponent.js"],"names":["React","hoistStatics","Modifiers","Scheme","forwardRef","UIComponent","asBaseComponent","WrappedComponent","BaseComponent","state","error","appearanceListener","setState","colorScheme","getSchemeType","addChangeListener","removeChangeListener","themeProps","getThemeProps","props","context","modifiers","generateModifiersStyle","undefined","forwardedRef","others","defaultProps","renderError","onError","call","displayName","propTypes"],"mappings":";;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAO,KAAKC,SAAZ;AACA,SAASC,MAAT;AACA,OAAOC,UAAP;AACA,OAAOC,WAAP;;;AAEA,SAASC,eAAT,CAAyBC,gBAAzB,EAA2C;AAAA,MACnCC,aADmC;AAAA;;AAAA;;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,YAEvCC,KAFuC,GAE/B;AACNC,QAAAA,KAAK,EAAE;AADD,OAF+B;;AAAA,YAcvCC,kBAduC,GAclB,YAAM;AAIzB,cAAKC,QAAL,CAAc;AACZC,UAAAA,WAAW,EAAEV,MAAM,CAACW,aAAP;AADD,SAAd;AAGD,OArBsC;;AAAA;AAAA;;AAAA;AAAA;AAAA,aAMvC,6BAAoB;AAClBX,QAAAA,MAAM,CAACY,iBAAP,CAAyB,KAAKJ,kBAA9B;AACD;AARsC;AAAA;AAAA,aAUvC,gCAAuB;AACrBR,QAAAA,MAAM,CAACa,oBAAP,CAA4B,KAAKL,kBAAjC;AACD;AAZsC;AAAA;AAAA,aAiCvC,kBAAS;AAAA;;AACP,YAAMM,UAAU,GAAGT,aAAa,CAACU,aAAd,CAA4B,KAAKC,KAAjC,EAAwC,KAAKC,OAA7C,CAAnB;AACA,YAAMC,SAAS,GAAGnB,SAAS,CAACoB,sBAAV,CAAiCC,SAAjC,EAA4CN,UAA5C,CAAlB;;AAGA,YACEO,YADF,GAGIP,UAHJ,CACEO,YADF;AAAA,YAEKC,MAFL,4BAGIR,UAHJ;;AAIA,eAAO,KAAKR,KAAL,CAAWC,KAAX,8BAAoBL,WAAW,CAACqB,YAAhC,qBAAoB,sBAA0BC,WAA9C,KAA6D,KAAC,gBAAD,kCAAsBF,MAAtB;AAA8B,UAAA,SAAS,EAAEJ,SAAzC;AAAoD,UAAA,GAAG,EAAEG;AAAzD,WAApE;AACD;AA3CsC;AAAA;AAAA,aA0BvC,kCAAgCd,KAAhC,EAAuC;AAAA;;AACrC,kCAAAL,WAAW,CAACqB,YAAZ,4CAA0BE,OAA1B,2CAA0BA,OAA1B,CAAoClB,KAApC,EAA2CH,gBAAgB,CAACmB,YAA5D;AACA,eAAO;AACLhB,UAAAA,KAAK,EAAE;AADF,SAAP;AAGD;AA/BsC;;AAAA;AAAA,IACbL,WADa;;AACnCG,EAAAA,aADmC,CAsBhCU,aAtBgC,GAsBhB,UAACC,KAAD,EAAQC,OAAR,EAAoB;AACzC,WAAOlB,SAAS,CAACgB,aAAV,CAAwBW,IAAxB,CAA6BtB,gBAA7B,EAA+CY,KAA/C,EAAsDC,OAAtD,CAAP;AACD,GAxBsC;;AAgDzCnB,EAAAA,YAAY,CAACO,aAAD,EAAgBD,gBAAhB,CAAZ;AACAC,EAAAA,aAAa,CAACsB,WAAd,GAA4BvB,gBAAgB,CAACuB,WAA7C;AACAtB,EAAAA,aAAa,CAACuB,SAAd,GAA0BxB,gBAAgB,CAACwB,SAA3C;AACAvB,EAAAA,aAAa,CAACkB,YAAd,GAA6BnB,gBAAgB,CAACmB,YAA9C;AACA,SAAOtB,UAAU,CAACI,aAAD,CAAjB;AACD;;AAED,eAAeF,eAAf","sourcesContent":["import React from 'react';\nimport hoistStatics from 'hoist-non-react-statics';\nimport * as Modifiers from \"./modifiers\";\nimport { Scheme } from \"../style\";\nimport forwardRef from \"./forwardRef\";\nimport UIComponent from \"./UIComponent\";\n\nfunction asBaseComponent(WrappedComponent) {\n  class BaseComponent extends UIComponent {\n    state = {\n      error: false\n    };\n\n    componentDidMount() {\n      Scheme.addChangeListener(this.appearanceListener);\n    }\n\n    componentWillUnmount() {\n      Scheme.removeChangeListener(this.appearanceListener);\n    }\n\n    appearanceListener = () => {\n      // iOS 13 and above will trigger this call with the wrong colorScheme value. So just ignore returned colorScheme for now\n      // https://github.com/facebook/react-native/issues/28525\n      // this.setState({colorScheme: Appearance.getColorScheme()});\n      this.setState({\n        colorScheme: Scheme.getSchemeType()\n      });\n    };\n    static getThemeProps = (props, context) => {\n      return Modifiers.getThemeProps.call(WrappedComponent, props, context);\n    };\n\n    static getDerivedStateFromError(error) {\n      UIComponent.defaultProps?.onError?.(error, WrappedComponent.defaultProps);\n      return {\n        error: true\n      };\n    }\n\n    render() {\n      const themeProps = BaseComponent.getThemeProps(this.props, this.context);\n      const modifiers = Modifiers.generateModifiersStyle(undefined, themeProps); // TODO: omit original modifiers props (left, right, flex, etc..)\n      // Because they throws an error when being passed to RNView on Android\n\n      const {\n        forwardedRef,\n        ...others\n      } = themeProps;\n      return this.state.error && UIComponent.defaultProps?.renderError || <WrappedComponent {...others} modifiers={modifiers} ref={forwardedRef} />;\n    }\n\n  } // Statics\n\n\n  hoistStatics(BaseComponent, WrappedComponent);\n  BaseComponent.displayName = WrappedComponent.displayName;\n  BaseComponent.propTypes = WrappedComponent.propTypes;\n  BaseComponent.defaultProps = WrappedComponent.defaultProps;\n  return forwardRef(BaseComponent);\n}\n\nexport default asBaseComponent;"]},"metadata":{},"sourceType":"module"}